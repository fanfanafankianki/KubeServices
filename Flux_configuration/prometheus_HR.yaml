apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
  name: prometheus-custom
  namespace: staging
spec:
  interval: 1m
  chart:
    spec:
      chart: ./HelmCharts/prometheus_prod
      sourceRef:
        kind: GitRepository
        name: flux-system
        namespace: flux-system
  values:
    prometheus:
      alertmanager:
        enabled: false
      server:
        persistentVolume:
          existingClaim: "prometheus-claim"
        service:
          type: NodePort
          nodePort: 30010
      serverFiles:
        prometheus.yml:
          scrape_configs:
            - job_name: 'jenkins'
              metrics_path: '/prometheus'
              static_configs:
                - targets: ['3.250.167.70:8080']

